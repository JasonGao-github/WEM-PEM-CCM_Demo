<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wemccm.quantityinput.dao.QuantityInputDao">


	<select id="selectAllQuantityInputItermGroup"
		resultType="com.wemccm.common.entity.QuantityInputItermGroup">
		SELECT * FROM quantityinputitermgroup
	</select>

	<select id="findQuantityInputBasicData"
		parameterType="com.wemccm.common.pojo.QuantityInputItermGroupIdPojo"
		resultType="com.wemccm.common.entity.QuantityInputBasicData">

		SELECT *

		FROM quantityinputbasicdata

		WHERE
		quantityInputItermGroupId=#{quantityInputItermGroupId}

	</select>

	<select id="insertQuantityInputBasicData"
		parameterType="com.wemccm.common.entity.QuantityInputBasicData">

		INSERT INTO quantityinputbasicdata
		(quantityInputItermGroupId,
		code,description,unit,labour,material,
		plant,subcontract,unitRate,manhours)
		VALUES
		(#{quantityInputItermGroupId},#{code},#{description},#{unit},#{labour},#{material},
		#{plant},#{subcontract},#{unitRate},#{manhours})

	</select>
	
	<select id="listAllQuantityInputBasicData"

		parameterType="Integer"
		resultType="com.wemccm.common.pojo.QuantityInputBasicDataGroupPojo">

		SELECT ci.* ,ig.`name`
		FROM quantityinputbasicdata as ci
		left join quantityinput as oc
		on ci.id=oc.quantityInputBasicDataId

		left join quantityinputitermgroup as ig
		on ig.id=ci.quantityInputItermGroupId
		
		
		WHERE
		oc.projectId =  #{projectId}

	</select>
	
		<select id="deleteQuantityInputBasicData"

		parameterType="com.wemccm.common.pojo.IdPojo">

			DELETE FROM quantityinputbasicdata
WHERE id= #{id}

	</select>
















	<select id="insertQuantityInput"
		parameterType="com.wemccm.common.pojo.QuantityInputPojo">

		INSERT INTO quantityinput (projectId,
		quantityInputBasicDataId,
		unit,
		labour,
		material,
		plant,
		subcontract,
		unitRate,
		manhours,
		actuals,recouverable,jemena,lcat,
		actualsSubTotal,recouverableSubTotal,jemenaSubTotal,lcatSubTotal)
		VALUES
		(#{projectId},#{quantityInputBasicDataId},
		#{unit},
		#{labour},
		#{material},
		#{plant},
		#{subcontract},
		#{unitRate},
		#{manhours},
		#{actuals},#{recouverable},#{jemena},#{lcat},
		#{actualsSubTotal},#{recouverableSubTotal},#{jemenaSubTotal},#{lcatSubTotal})

	</select>




	<!--逻辑有问题？？主表应该是quantityinput？？ -->
	<select id="findQuantityInputDetail"
		parameterType="com.wemccm.common.pojo.projectIdPojo"
		resultType="com.wemccm.common.pojo.QuantityInputDetailPojo">


		SELECT qi.*,ibd.*,iig.`name`,iig.`code` as
		QuantityInputItermGroupCode

		FROM quantityinputbasicdata as ibd

		LEFT JOIN
		quantityinputitermgroup as iig
		ON
		ibd.quantityInputItermGroupId=iig.id

		LEFT JOIN quantityinput as qi
		ON qi.quantityInputBasicDataId=ibd.id

		WHERE projectId=#{projectId}

	</select>


	<select id="getByCode"
		parameterType="String"
		resultType="com.wemccm.common.entity.QuantityInputBasicData">
		SELECT * FROM quantityinputbasicdata WHERE code=#{code}
	</select>









</mapper>